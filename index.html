<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8 />
    <title>Where to Watch College Football around Denver | The Denver Post</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.css' rel='stylesheet' />
    <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.css' rel='stylesheet' />
    <link href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.Default.css' rel='stylesheet' />
    <link rel="stylesheet" href="http://extras.denverpost.com/foundation/css/foundation.css" />
    <link rel="stylesheet" href="http://extras.denverpost.com/foundation/css/normalize.css" />
    <link rel="shortcut icon" href="http://extras.mnginteractive.com/live/media/favIcon/dpo/favicon.ico" type="image/x-icon" />
    <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.9/mapbox.js'></script>
    <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js'></script>
    <script src="http://extras.denverpost.com/foundation/js/vendor/modernizr.js"></script>
    <style>
        body {
            margin-top: 25px;
            padding: 0;
        }
        #map {
            /* position: absolute;
            top: 0;
            bottom: 0; */
            width: 100%;
            height: 500px;
            float: left;
        }
        #stores {
            /* position: absolute;
            top: 0;
            right: 0;
            background: #ccc;
            width: 150px;
            padding: 5px; */
        }
        div.legend {
            /* margin: 5px 5px 5px 5px;
            font-family: Helvetica;
            height: 100%;
            width: 93%; */
            margin-bottom: -9px;
        }
        div.legend-container {
            width: 20%;
            float: right;
        }
        div.leaflet-popup-content {
            font-size: 17px;
        }
    </style>
</head>

<body>
    <div class="row">
        <div class="large-9 medium-8 small-12 columns">
            <div id='map'></div>
        </div>
        <div class="large-3 medium-4 small-12 columns">
            <form id='teams'>
            <div id="legend-container">
                <div class="legend" id="alabama">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='alabama' > Alabama
                </div>
                <div class="legend" id="arizona-state">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='arizonaState' > Arizona State
                    </label>
                </div>
                <div class="legend" id="auburn">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='auburn' > Auburn
                    </label>
                </div>
                <div class="legend" id="baylor">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='baylor' > Baylor
                    </label>
                </div>
                <div class="legend" id="csu-foco">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='csuRams' > CSU Rams
                    </label>
                </div>
                <div class="legend" id="csu-pueblo">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='csuPueblo' > CSU Pueblo
                    </label>
                </div>
                <div class="legend" id="cu">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='cuBuffs' checked> CU Buffs
                    </label>
                </div>
                <div class="legend" id="florida">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='florida' > Florida
                    </label>
                </div>
                <div class="legend" id="florida-state">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='floridaState' > Florida State
                    </label>
                </div>
                <div class="legend" id="georgia">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='georgia' > Georgia
                    </label>
                </div>
                <div class="legend" id="illinois">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='illinois' > Illinois
                    </label>
                </div>
                <div class="legend" id="iowa">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='iowa' > Iowa
                    </label>
                </div>
                <div class="legend" id="lsu">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='lsu' > LSU
                    </label>
                </div>
                <div class="legend" id="michigan">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='michigan' > Michigan
                    </label>
                </div>
                <div class="legend" id="michigan-state">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='michiganState' > Michigan State
                    </label>
                </div>
                <div class="legend" id="missouri">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='missouri' > Missouri
                    </label>
                </div>
                <div class="legend" id="nebraska">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='nebraska' > Nebraska
                    </label>
                </div>
                <div class="legend" id="northwestern">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='northwestern' > Northwestern
                    </label>
                </div>
                <div class="legend" id="ohio-state">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='ohioState' > Ohio State
                    </label>
                </div>
                <div class="legend" id="oklahoma">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='oklahoma' > Oklahoma
                    </label>
                </div>
                <div class="legend" id="oklahoma-state">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='oklahomaState' > Oklahoma State
                    </label>
                </div>
                <div class="legend" id="penn-state">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='pennState' > Penn State
                    </label>
                </div>
                <div class="legend" id="pittsburgh">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='pittsburgh' > Pittsburgh
                    </label>
                </div>
                <div class="legend" id="purdue">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='purdue' > Purdue
                    </label>
                </div>
                <div class="legend" id="tcu">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='tcu' > TCU
                    </label>
                </div>
                <div class="legend" id="texas-am">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='texasAm' > Texas A&amp;M
                    </label>
                </div>
                <div class="legend" id="usc">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='usc' > USC
                    </label>
                </div>
                <div class="legend" id="virginia-tech">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='virginiaTech' > Virginia Tech
                    </label>
                </div>
                <div class="legend" id="washington">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='washington' > Washington
                    </label>
                </div>
                <div class="legend" id="west-virginia">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='westVirginia' > West Virginia
                    </label>
                </div>
                <div class="legend" id="wisconsin">
                    <label>
                    	<input type='radio' name='filters' onclick='showTeamNames();' value='wisconsin' > Wisconsin
                    </label>
                </div>
                <div class="legend" id="wyoming">
                    <label>
                    	<label>
                    		<input type='radio' name='filters' onclick='showTeamNames();' value='wyoming'> Wyoming
                    </label>
                </div>
            </form>
        </div>
    </div>

    <script>
        L.mapbox.accessToken = 'pk.eyJ1Ijoia2hhbW0tZGVudmVycG9zdCIsImEiOiJjNmQ1Y2YzNzk1NDJjNjg1Nzc0OTg0Zjc2OWE5Yzg2OCJ9.3pfE4zLWvuT_R35ZfEMnrQ';
        // Here we don't use the second argument to map, since that would automatically
        // load in non-clustered markers from the layer. Instead we add just the
        // backing tileLayer, and then use the featureLayer only for its data.
        var map = L.mapbox.map('map')
            .setView([39.7392, -104.9903], 10)
            .addLayer(L.mapbox.tileLayer('mapbox.streets'));

        var overlays = L.layerGroup().addTo(map);

        // we create the 'layers' variable outside of the on('ready' callback
        // so that it can be accessible in the showStations function. Otherwise,
        // JavaScript scope would prevent you from accessing it.
        var layers;

        // Since featureLayer is an asynchronous method, we use the `.on('ready'`
        // call to only use its marker data once we know it is actually loaded.
        L.mapbox.featureLayer()
            .loadURL('college-football-map.geojson')
            .on('ready', function(e) {
                layers = e.target;
                console.log(e);
                showTeamNames();
            });

        var filters = document.getElementById('teams').filters;

        // There are many ways to filter data. Mapbox.js has the .setFilter method,
        // but it only applies to L.mapbox.featureLayer layers, and that isn't what
        // we're creating - we're making marker groups in a MarkerClusterGroup layer.
        // Thus we distill filtering down to its essential part: an 'if' statement
        // in a loop.
        function showTeamNames() {
                // first collect all of the checked boxes and create an array of strings
                // like ['green', 'blue']
                var list = [];
                for (var i = 0; i < filters.length; i++) {
                    if (filters[i].checked) list.push(filters[i].value);
                }
                // then remove any previously-displayed marker groups
                overlays.clearLayers();
                // create a new marker group
                var clusterGroup = new L.MarkerClusterGroup().addTo(overlays);
                // and add any markers that fit the filtered criteria to that group.
                layers.eachLayer(function(layer) {
                    if (list.indexOf(layer.feature.properties.teamId) !== -1) {
                        layer.bindPopup(layer.feature.properties.teamName + '<br>' + layer.feature.properties.location + '<br>' + layer.feature.properties.address);
                        clusterGroup.addLayer(layer);
                    }
                });
            }
    </script>
</body>
</html>